---
title: "C++之友元和继承"
date: 2025-11-03 12:00:00 +0800
categories: [C++]
tags: [C++,friend,inheritance]
---


## 友元是无法被继承的

直接看两个例子
```cpp
class A {
    friend class B;
private:
    int run() {return 0;}
};

class A_Child:public A{
private:
    int run_2() {return 1;}
};

class B {
public:
    A a;
    int foo_1() {return a.run() + 1;}
    A_Child a_child;
    int foo_2() {
        int res = a_child.run();
        res += a_child.run_2();//编译错误function "A_Child::run_2" (declared at line 11) is inaccessibleC/C++(265)
        return res + 2;}
};
```
A里定义了B是A的friend类，那么B可以访问A的私有函数或变量;
A_Child public继承于A, 但是友元关系无法被继承，所以B无法访问A的私有函数或变量;
注意这里 B 依然可以调用a_child.run()，因为实际调用的是A::run();

下面是另一个例子：
```cpp
class A {
    friend class B;
private:
    int run() {return 0;}
};

class B {
public:
    A a;
    int foo_1() {return a.run() + 1;}
};

class B_Child: public B {
public:
    A a;
    int foo_2() {return a.run() + 1;}//编译错误function "A::run" (declared at line 6) is inaccessibleC/C++(265)
};
```
B是A的friend类，但是B_Child 并不是A 的friend类;
注意假如B_Child没有修改foo_1()，可以通过B_child::foo_1()去调用A里的私有变量(因为实际上是B::foo_1());

## 总结：
友元关系无法继承。