---
title: "C++之为什么需要友元"
date: 2025-11-03 12:00:00 +0800
categories: [C++]
tags: [C++, friend]
---

友元函数或友元类（friend）是什么不必多说，但是为什么C++需要引入一个破坏封装的机制呢？

## 核心目的

某些函数需要访问类的私有成员，但又不属于该类的成员函数时，可以通过 friend 授予有限的访问权限。
典型的应用场景是用cout<< 打印自定义class里的私有变量
比方说：

```cpp
class Point {
private:
    int x, y;
public:
    Point(int x, int y) : x(x), y(y) {}
    friend std::ostream& operator<<(std::ostream& os, const Point& p);
};

std::ostream& operator<<(std::ostream& os, const Point& p) {
    return os << "(" << p.x << ", " << p.y << ")";
}
```

我们希望cout<<能直接打印自定义类的私有变量。
而 operator<<的左操作数是ostream,并不是我们的类Point。
所以我们这个operator<<重载，一定是要在类Point外的。
但是既然定义在类外，又无法获取到类Point的私有变量。

假设没有引入友元，那我们需要修改std::ostream 这个类，这显然非常不现实。

## 总结：
friend 是一种受控的封装破例，提供了方便同时保持了语义上的安全性。